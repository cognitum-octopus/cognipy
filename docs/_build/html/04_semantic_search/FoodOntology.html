

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>‘Semantic search’. &mdash; CogniPy 0.1.6 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Refrence" href="../modules.html" />
    <link rel="prev" title="‘African Wildlife’." href="../01_safari_explorer/Safari.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> CogniPy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">CogniPy Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Project description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../grammar.html">Grammar</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../01_safari_explorer/Safari.html">‘African Wildlife’.</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">‘Semantic search’.</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">API Refrence</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CogniPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>‘Semantic search’.</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/04_semantic_search/FoodOntology.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="‘Semantic-search’.">
<h1>‘Semantic search’.<a class="headerlink" href="#‘Semantic-search’." title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">cognipy.ontology</span> <span class="kn">import</span> <span class="n">Ontology</span>
<span class="kn">from</span> <span class="nn">cognipy.ontology</span> <span class="kn">import</span> <span class="n">CQL</span>
<span class="kn">from</span> <span class="nn">cognipy.ontology</span> <span class="kn">import</span> <span class="n">ABoxBatch</span>
<span class="kn">from</span> <span class="nn">cognipy.ontology</span> <span class="kn">import</span> <span class="n">encode_string_for_graph_label</span>
<span class="kn">from</span> <span class="nn">cognipy.edit</span> <span class="kn">import</span> <span class="n">CnlEditBox</span>
<span class="kn">from</span> <span class="nn">cognipy.edit</span> <span class="kn">import</span> <span class="n">CnlQueryForConcept</span>

<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">graph_attribute_formatter</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="nb">set</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span><span class="n">encode_string_for_graph_label</span><span class="p">(</span><span class="n">graph_attribute_formatter</span><span class="p">(</span><span class="n">i</span><span class="p">)),</span><span class="n">val</span><span class="p">)))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot; | &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot; : &quot;</span><span class="o">+</span><span class="n">encode_string_for_graph_label</span><span class="p">(</span><span class="n">graph_attribute_formatter</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span><span class="n">val</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">encode_string_for_graph_label</span><span class="p">(</span><span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">),</span><span class="mi">40</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">string_evaluator</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;unicode_escape&#39;</span><span class="p">),</span><span class="nb">globals</span><span class="p">(),</span><span class="nb">locals</span><span class="p">())</span>

<span class="kn">from</span> <span class="nn">pint</span> <span class="kn">import</span> <span class="n">UnitRegistry</span>
<span class="n">ureg</span> <span class="o">=</span> <span class="n">UnitRegistry</span><span class="p">()</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span>

<span class="k">def</span> <span class="nf">Qstr</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="s2">&quot;Q(&#39;&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;&#39;)&quot;</span>
<span class="n">Q</span><span class="o">.</span><span class="fm">__repr__</span><span class="o">=</span><span class="n">Qstr</span>

<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ed</span><span class="o">=</span><span class="n">CnlEditBox</span><span class="p">(</span><span class="s1">&#39;meta.encnl&#39;</span><span class="p">)</span>
<span class="n">ed</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "059baa05c7174dc2ad0b0b63cb144979", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">Ontology</span><span class="p">(</span><span class="s2">&quot;cnl/file&quot;</span><span class="p">,</span><span class="s1">&#39;meta.encnl&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">draw_graph</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/04_semantic_search_FoodOntology_3_0.svg" src="../_images/04_semantic_search_FoodOntology_3_0.svg" /></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ed</span><span class="o">=</span><span class="n">CnlEditBox</span><span class="p">(</span><span class="s1">&#39;meat-beef.encnl&#39;</span><span class="p">)</span>
<span class="n">ed</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "cd5e403cd09345ea925b63a8555fc2cb", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">onto</span> <span class="o">=</span> <span class="n">Ontology</span><span class="p">(</span><span class="s2">&quot;cnl/file&quot;</span><span class="p">,</span><span class="s1">&#39;meat-beef.encnl&#39;</span><span class="p">,</span> <span class="n">evaluator</span> <span class="o">=</span> <span class="n">string_evaluator</span><span class="p">,</span> <span class="n">graph_attribute_formatter</span> <span class="o">=</span> <span class="n">graph_attribute_formatter</span><span class="p">)</span>
<span class="n">onto</span><span class="o">.</span><span class="n">draw_graph</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;is-broader-trans-than&quot;</span><span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/04_semantic_search_FoodOntology_5_0.svg" src="../_images/04_semantic_search_FoodOntology_5_0.svg" /></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">generateMoreFromExisting</span><span class="p">(</span><span class="n">onto</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;meat-beef-cat.encnl&#39;</span><span class="p">,</span><span class="s1">&#39;wt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">iName</span> <span class="ow">in</span> <span class="n">onto</span><span class="o">.</span><span class="n">select_instances_of</span><span class="p">(</span><span class="s2">&quot;a product&quot;</span><span class="p">)[</span><span class="s2">&quot;Instance&quot;</span><span class="p">]:</span>
            <span class="n">iCatName</span><span class="o">=</span><span class="n">iName</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&quot;Product$&#39;</span><span class="p">,</span><span class="s1">&#39;&quot;Category$&#39;</span><span class="p">)</span>
            <span class="n">iCatName</span><span class="o">=</span><span class="n">iCatName</span><span class="p">[:</span><span class="n">iCatName</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)]</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span>
            <span class="n">file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">iName</span><span class="o">+</span><span class="s2">&quot; is-inside &quot;</span><span class="o">+</span><span class="n">iCatName</span><span class="o">+</span><span class="s2">&quot;.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="n">onto</span><span class="o">.</span><span class="n">select_instances_of</span><span class="p">(</span><span class="s2">&quot;a facet&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">iFacet</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Instance&quot;</span><span class="p">]</span>
            <span class="n">values</span><span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;has-value&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                <span class="n">fval</span><span class="o">=</span><span class="n">iFacet</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;/&quot;</span><span class="o">+</span><span class="n">val</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span>
                <span class="n">file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">fval</span><span class="o">+</span><span class="s2">&quot; is a facet-option.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">fval</span><span class="o">+</span><span class="s1">&#39; is-an-option-for &#39;</span><span class="o">+</span><span class="n">iFacet</span><span class="o">+</span><span class="s1">&#39;.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">References:</span>
<span class="s2">[] (&#39;./meat-beef.encnl&#39;).&quot;&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">generateMoreFromExisting</span><span class="p">(</span><span class="n">onto</span><span class="p">)</span>
<span class="n">ed2</span><span class="o">=</span><span class="n">CnlEditBox</span><span class="p">(</span><span class="s1">&#39;meat-beef-cat.encnl&#39;</span><span class="p">)</span>
<span class="n">ed2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9f00e7152b8e4edfa6ce47101a6583d7", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">onto</span> <span class="o">=</span> <span class="n">Ontology</span><span class="p">(</span><span class="s2">&quot;cnl/file&quot;</span><span class="p">,</span><span class="s1">&#39;meat-beef-cat.encnl&#39;</span><span class="p">,</span> <span class="n">evaluator</span> <span class="o">=</span> <span class="n">string_evaluator</span><span class="p">,</span> <span class="n">graph_attribute_formatter</span> <span class="o">=</span> <span class="n">graph_attribute_formatter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">fuzzy</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dmeta</span> <span class="o">=</span> <span class="n">fuzzy</span><span class="o">.</span><span class="n">DMetaphone</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">makeTags</span><span class="p">(</span><span class="n">wrd</span><span class="p">):</span>
    <span class="n">wrdl</span><span class="o">=</span><span class="n">wrd</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">tgs</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="n">wrdl</span><span class="p">)]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">wrdl</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">4</span><span class="p">:</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="n">dmeta</span><span class="p">(</span><span class="n">wrdl</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tgs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">t</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">tgs</span>

<span class="k">def</span> <span class="nf">tagifySerie</span><span class="p">(</span><span class="n">ser</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">iName</span> <span class="ow">in</span> <span class="n">ser</span><span class="p">:</span>
        <span class="n">name</span><span class="o">=</span><span class="n">iName</span><span class="p">[</span><span class="n">iName</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">name_tags</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">yy</span> <span class="ow">in</span> <span class="n">y</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">yy</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">):</span>
                        <span class="n">name_tags</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">makeTags</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">name_tags</span><span class="p">):</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">t</span><span class="p">,</span><span class="n">iName</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">tagsForString</span><span class="p">(</span><span class="n">searchStr</span><span class="p">,</span><span class="n">exclude</span><span class="p">):</span>
    <span class="n">dmeta</span> <span class="o">=</span> <span class="n">fuzzy</span><span class="o">.</span><span class="n">DMetaphone</span><span class="p">()</span>
    <span class="n">toret</span><span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="p">[</span><span class="n">makeTags</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">searchStr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">y</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">exclude</span><span class="p">)]</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">toret</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">tagifySerie2</span><span class="p">(</span><span class="n">ser</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">iName</span> <span class="ow">in</span> <span class="n">ser</span><span class="p">:</span>
        <span class="n">name</span><span class="o">=</span><span class="n">iName</span><span class="p">[</span><span class="n">iName</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">name_tags</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">yy</span> <span class="ow">in</span> <span class="n">y</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">):</span>
                    <span class="n">spl</span><span class="o">=</span><span class="n">yy</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
                    <span class="n">name_tags</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="n">s</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spl</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">spl</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                        <span class="n">name_tags</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">tuple</span><span class="p">(</span><span class="n">spl</span><span class="p">),</span><span class="mi">1</span><span class="p">))</span>

        <span class="n">more</span> <span class="o">=</span> <span class="p">[(</span><span class="n">dmeta</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="p">((</span><span class="n">dmeta</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span><span class="n">dmeta</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])),</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">name_tags</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">name_tags</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">more</span><span class="p">)):</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">t</span><span class="p">,</span><span class="n">iName</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">buildBroaderThanThanRelation</span><span class="p">(</span><span class="n">catspd</span><span class="p">,</span><span class="n">rel</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="s2">&quot;subid&quot;</span><span class="p">]):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">catspd</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">iName</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Instance&quot;</span><span class="p">]</span>
        <span class="n">iBroaders</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">rel</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">iBroaders</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iBroaders</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">iName</span><span class="p">,</span><span class="n">iBroaders</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">iBroader</span> <span class="ow">in</span> <span class="n">iBroaders</span><span class="p">:</span>
                    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">iName</span><span class="p">,</span><span class="n">iBroader</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">buildInsideCategoryRelation</span><span class="p">(</span><span class="n">prodspd</span><span class="p">,</span><span class="n">rel</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="s2">&quot;mainid&quot;</span><span class="p">]):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">prodspd</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">iName</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;Instance&quot;</span><span class="p">]</span>
        <span class="n">iCat</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">rel</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">iCat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">iName</span><span class="p">,</span><span class="n">iCat</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">catspd</span><span class="o">=</span><span class="n">onto</span><span class="o">.</span><span class="n">sparql_query</span><span class="p">(</span><span class="n">CQL</span><span class="p">(</span><span class="s1">&#39;select ?x ?y ?z {?x rdf:type &lt;category&gt;. optional{?y rdf:type &lt;category&gt;. ?x &lt;is-broader-trans-than&gt; ?y}. optional{?z rdf:type &lt;facet&gt;. ?x &lt;is-faceted-by&gt; ?z}}&#39;</span><span class="p">),</span><span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Instance&#39;</span><span class="p">,</span><span class="s1">&#39;is-broader-trans-than&#39;</span><span class="p">,</span><span class="s1">&#39;is-faceted-by&#39;</span><span class="p">])</span>
<span class="n">categoryHierarchy</span><span class="o">=</span><span class="n">onto</span><span class="o">.</span><span class="n">sparql_query</span><span class="p">(</span><span class="n">CQL</span><span class="p">(</span><span class="s1">&#39;select ?x ?y {?x rdf:type &lt;category&gt;. ?y rdf:type &lt;category&gt;. ?x &lt;is-broader-than&gt; ?y}&#39;</span><span class="p">),</span><span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;super&#39;</span><span class="p">,</span><span class="s1">&#39;sub&#39;</span><span class="p">])</span>
<span class="n">prodspd</span><span class="o">=</span><span class="n">onto</span><span class="o">.</span><span class="n">sparql_query</span><span class="p">(</span><span class="n">CQL</span><span class="p">(</span><span class="s1">&#39;select ?x ?y ?z {?x rdf:type &lt;product&gt;. optional{?y rdf:type &lt;category&gt;. ?x &lt;is-inside&gt; ?y}. optional{?z rdf:type &lt;facet&gt;. ?x &lt;is-faceted-by&gt; ?z}}&#39;</span><span class="p">),</span><span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Instance&#39;</span><span class="p">,</span><span class="s1">&#39;is-inside&#39;</span><span class="p">,</span><span class="s1">&#39;is-faceted-by&#39;</span><span class="p">])</span>
<span class="n">facvalpd</span><span class="o">=</span><span class="n">onto</span><span class="o">.</span><span class="n">sparql_query</span><span class="p">(</span><span class="n">CQL</span><span class="p">(</span><span class="s1">&#39;select ?x ?y {?x rdf:type &lt;facet-option&gt;. ?y rdf:type &lt;facet&gt;. ?x &lt;is-an-option-for&gt; ?y}&#39;</span><span class="p">),</span><span class="n">column_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Instance&#39;</span><span class="p">,</span><span class="s1">&#39;is-an-option-for&#39;</span><span class="p">])</span>

<span class="n">catetoryTagIndex</span><span class="o">=</span><span class="n">tagifySerie</span><span class="p">(</span><span class="n">catspd</span><span class="p">[</span><span class="s1">&#39;Instance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
<span class="n">categoryBroaderThanThanRelation</span><span class="o">=</span><span class="n">buildBroaderThanThanRelation</span><span class="p">(</span><span class="n">catspd</span><span class="p">,</span><span class="s1">&#39;is-broader-trans-than&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;broaderid&quot;</span><span class="p">,</span><span class="s2">&quot;catid&quot;</span><span class="p">])</span>
<span class="n">productTagIndex</span> <span class="o">=</span><span class="n">tagifySerie</span><span class="p">(</span><span class="n">prodspd</span><span class="p">[</span><span class="s1">&#39;Instance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
<span class="n">productInsideCategoryRelation</span><span class="o">=</span><span class="n">buildInsideCategoryRelation</span><span class="p">(</span><span class="n">prodspd</span><span class="p">,</span><span class="s1">&#39;is-inside&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="s2">&quot;mainid&quot;</span><span class="p">])</span>
<span class="n">valuesInsideFacetRelation</span><span class="o">=</span><span class="n">buildInsideCategoryRelation</span><span class="p">(</span><span class="n">facvalpd</span><span class="p">,</span><span class="s1">&#39;is-an-option-for&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="s2">&quot;mainid&quot;</span><span class="p">])</span>
<span class="n">facetValTagIndex</span> <span class="o">=</span><span class="n">tagifySerie</span><span class="p">(</span><span class="n">facvalpd</span><span class="p">[</span><span class="s1">&#39;Instance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
<span class="n">categoryFacetRelation</span><span class="o">=</span><span class="n">buildBroaderThanThanRelation</span><span class="p">(</span><span class="n">catspd</span><span class="p">,</span><span class="s1">&#39;is-faceted-by&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;catid&quot;</span><span class="p">,</span><span class="s2">&quot;facetid&quot;</span><span class="p">])</span>
<span class="n">productFacetRelation</span><span class="o">=</span><span class="n">buildBroaderThanThanRelation</span><span class="p">(</span><span class="n">prodspd</span><span class="p">,</span><span class="s1">&#39;is-faceted-by&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;prodid&quot;</span><span class="p">,</span><span class="s2">&quot;facetid&quot;</span><span class="p">])</span>
<span class="n">database</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;catetoryTagIndex&#39;</span><span class="p">:</span><span class="n">catetoryTagIndex</span><span class="p">,</span>
          <span class="s1">&#39;categoryBroaderThanThanRelation&#39;</span><span class="p">:</span><span class="n">categoryBroaderThanThanRelation</span><span class="p">,</span>
          <span class="s1">&#39;productTagIndex&#39;</span><span class="p">:</span><span class="n">productTagIndex</span><span class="p">,</span>
          <span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">:</span><span class="n">productInsideCategoryRelation</span><span class="p">,</span>
          <span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">:</span><span class="n">valuesInsideFacetRelation</span><span class="p">,</span>
          <span class="s1">&#39;facetValTagIndex&#39;</span><span class="p">:</span><span class="n">facetValTagIndex</span><span class="p">,</span>
          <span class="s1">&#39;categoryFacetRelation&#39;</span><span class="p">:</span><span class="n">categoryFacetRelation</span><span class="p">,</span>
          <span class="s1">&#39;productFacetRelation&#39;</span><span class="p">:</span><span class="n">productFacetRelation</span><span class="p">,</span>
          <span class="s1">&#39;categoryHierarchy&#39;</span><span class="p">:</span><span class="n">categoryHierarchy</span>
         <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">lookupForString</span><span class="p">(</span><span class="n">tagIndex</span><span class="p">,</span><span class="n">searchStr</span><span class="p">,</span><span class="n">exclude</span><span class="o">=</span><span class="p">{},</span><span class="n">nmax</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">pticnt</span><span class="o">=</span><span class="n">tagIndex</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;tag&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
    <span class="n">resc</span><span class="o">=</span><span class="n">tagIndex</span><span class="p">[(</span><span class="n">tagIndex</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">tagsForString</span><span class="p">(</span><span class="n">searchStr</span><span class="p">,</span><span class="n">exclude</span><span class="p">)))][[</span><span class="s1">&#39;tag&#39;</span><span class="p">,</span><span class="s1">&#39;id&#39;</span><span class="p">]]</span>
    <span class="n">apl</span><span class="o">=</span><span class="n">resc</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">pticnt</span><span class="p">[</span><span class="n">pticnt</span><span class="o">.</span><span class="n">index</span><span class="o">==</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;tag&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
    <span class="n">resc</span><span class="p">[</span><span class="s1">&#39;frac&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">apl</span>
    <span class="n">pdCounts</span><span class="o">=</span><span class="n">resc</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pdCounts</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="nb">max</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pdCounts</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="n">nmax</span><span class="p">,</span><span class="s1">&#39;frac&#39;</span><span class="p">)[</span><span class="s1">&#39;frac&#39;</span><span class="p">])</span>
    <span class="n">winCats</span><span class="o">=</span><span class="n">pdCounts</span><span class="p">[</span><span class="n">pdCounts</span><span class="p">[</span><span class="s1">&#39;frac&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="nb">max</span><span class="p">)]</span>
    <span class="n">wss</span><span class="o">=</span><span class="p">[(</span><span class="n">w</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">w</span><span class="p">[</span><span class="s1">&#39;frac&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="n">winCats</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()]</span>
    <span class="n">wss</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">wss</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">searchStr</span><span class="o">=</span><span class="s1">&#39;meat cow waygu sex cl 80&#39;</span>

<span class="n">selectedCatLst</span><span class="o">=</span><span class="n">lookupForString</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;catetoryTagIndex&#39;</span><span class="p">],</span><span class="n">searchStr</span><span class="p">)</span>
<span class="n">selectedCat</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">selectedCatLst</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
    <span class="n">serie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;productTagIndex&#39;</span><span class="p">]</span>\
                    <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span>\
                            <span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">mainid</span><span class="p">:(</span><span class="n">mainid</span> <span class="ow">in</span> <span class="n">selectedCat</span><span class="p">))]</span>\
                    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">serie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;productTagIndex&#39;</span><span class="p">]</span>

<span class="n">selectedProd</span><span class="o">=</span><span class="n">lookupForString</span><span class="p">(</span><span class="n">serie</span><span class="p">,</span><span class="n">searchStr</span><span class="p">,</span><span class="n">exclude</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">tagifySerie</span><span class="p">([</span><span class="n">selectedCatLst</span><span class="p">[</span><span class="mi">0</span><span class="p">]])[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="p">{})</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
    <span class="n">selectedCatLst</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
    <span class="n">selectedCat</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">selectedCatLst</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">selectedProdLst</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
    <span class="n">selectedProd</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">selectedProdLst</span><span class="p">)</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
    <span class="n">facetProdSerie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;productFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;prodid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)]</span>
    <span class="n">facetProdSerie</span> <span class="o">=</span> <span class="n">facetProdSerie</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;mainid&#39;</span><span class="p">),</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;facetid&#39;</span><span class="p">],</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
    <span class="n">facetProdSerie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;facetValTagIndex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">facetProdSerie</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">facetProdSerie</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
    <span class="n">broaderThanSelectedCat</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryBroaderThanThanRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryBroaderThanThanRelation&#39;</span><span class="p">][</span><span class="s1">&#39;catid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)][</span><span class="s1">&#39;broaderid&#39;</span><span class="p">])</span>
    <span class="n">broaderOrEqualThanSelectedCat</span><span class="o">=</span><span class="n">selectedCat</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">broaderThanSelectedCat</span><span class="p">)</span>
    <span class="n">facetSerie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;catid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">broaderOrEqualThanSelectedCat</span><span class="p">)]</span>
    <span class="n">facetSerie</span> <span class="o">=</span> <span class="n">facetSerie</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;mainid&#39;</span><span class="p">),</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;facetid&#39;</span><span class="p">],</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
    <span class="n">facetSerie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;facetValTagIndex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">facetSerie</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">facetSerie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;facetValTagIndex&#39;</span><span class="p">]</span>

<span class="n">selectedFacetVal</span><span class="o">=</span><span class="n">lookupForString</span><span class="p">(</span><span class="n">facetSerie</span><span class="p">,</span><span class="n">searchStr</span><span class="p">,</span><span class="n">exclude</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">tagifySerie</span><span class="p">([</span><span class="n">selectedCatLst</span><span class="p">[</span><span class="mi">0</span><span class="p">]])[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="p">{},</span><span class="n">nmax</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">facetProdSerie</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">selectedFacetProdVal</span><span class="o">=</span><span class="n">lookupForString</span><span class="p">(</span><span class="n">facetProdSerie</span><span class="p">,</span><span class="n">searchStr</span><span class="p">,</span><span class="n">exclude</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">tagifySerie</span><span class="p">([</span><span class="n">selectedCatLst</span><span class="p">[</span><span class="mi">0</span><span class="p">]])[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="p">{},</span><span class="n">nmax</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">selectedFacetProdVal</span><span class="o">=</span><span class="p">[]</span>

<span class="n">selectedFacetLst</span><span class="o">=</span><span class="p">[]</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedFacetVal</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
    <span class="n">selectedFacetLst</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedFacetVal</span><span class="p">)][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">selectedCatLst</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
        <span class="n">selectedCat</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">selectedCatLst</span><span class="p">)</span>

<span class="n">selectedFacetProdLst</span><span class="o">=</span><span class="p">[]</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedFacetProdVal</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
    <span class="n">selectedFacetProdLst</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedFacetProdVal</span><span class="p">)][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
    <span class="n">selectedProdLst</span><span class="o">=</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;facetid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedFacetProdLst</span><span class="p">)][</span><span class="s1">&#39;prodid&#39;</span><span class="p">]</span>
    <span class="n">selectedProd</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">selectedProdLst</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">selectedCatLst</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
        <span class="n">selectedCat</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">selectedCatLst</span><span class="p">)</span>

<span class="n">possibleFacets</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
    <span class="n">broaderThanSelectedCat</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryBroaderThanThanRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryBroaderThanThanRelation&#39;</span><span class="p">][</span><span class="s1">&#39;catid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)][</span><span class="s1">&#39;broaderid&#39;</span><span class="p">])</span>
    <span class="n">broaderOrEqualThanSelectedCat</span><span class="o">=</span><span class="n">selectedCat</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">broaderThanSelectedCat</span><span class="p">)</span>
    <span class="n">possibleFacets</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;catid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">broaderOrEqualThanSelectedCat</span><span class="p">)][</span><span class="s1">&#39;facetid&#39;</span><span class="p">])</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
    <span class="n">facetProdSerie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;productFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;prodid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)][</span><span class="s1">&#39;facetid&#39;</span><span class="p">]</span>
    <span class="n">possibleFacets</span><span class="o">=</span><span class="n">possibleFacets</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">facetProdSerie</span><span class="p">)</span>

<span class="n">facets</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">facet</span> <span class="ow">in</span> <span class="n">possibleFacets</span><span class="p">:</span>
    <span class="n">fctvals</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">facet</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
    <span class="n">tags</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;facetValTagIndex&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;facetValTagIndex&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">fctvals</span><span class="p">)]</span>
    <span class="n">selectedFacetVal</span><span class="o">=</span><span class="n">lookupForString</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span><span class="n">searchStr</span><span class="p">,</span><span class="n">exclude</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">tagifySerie</span><span class="p">([</span><span class="n">selectedCatLst</span><span class="p">[</span><span class="mi">0</span><span class="p">]])[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="p">{},</span><span class="n">nmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">facets</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;facet&#39;</span><span class="p">:</span><span class="n">facet</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span><span class="n">selectedFacetVal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedFacetVal</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">})</span>

<span class="n">ret</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span><span class="n">selectedCatLst</span><span class="p">,</span> <span class="s1">&#39;product&#39;</span><span class="p">:</span><span class="n">selectedProd</span><span class="p">,</span> <span class="s1">&#39;facets&#39;</span><span class="p">:</span><span class="n">facets</span><span class="p">}</span>
<span class="n">ret</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;category&#39;: [&#39;The-&#34;Internal$Food/Meat/Beef/Cut/Grinding&#34;&#39;,
  &#39;The-&#34;Category$Food/Meat/Beef&#34;&#39;],
 &#39;product&#39;: {&#39;The-&#34;Product$Food/Meat/Beef/Grinding=Minced&#34;&#39;},
 &#39;facets&#39;: [{&#39;facet&#39;: &#39;The-&#34;Facet$Food/Meat/Beef/Age Sex&#34;&#39;,
   &#39;value&#39;: &#39;The-&#34;Facet$Food/Meat/Beef/Age Sex/Cow=C&#34;&#39;},
  {&#39;facet&#39;: &#39;The-&#34;Facet$Food/Meat/Minced&#34;&#39;,
   &#39;value&#39;: &#39;The-&#34;Facet$Food/Meat/Minced/80 CL&#34;&#39;},
  {&#39;facet&#39;: &#39;The-&#34;Facet$Food/Meat/Beef/Meat Color&#34;&#39;, &#39;value&#39;: None},
  {&#39;facet&#39;: &#39;The-&#34;Facet$Food/Meat/Beef/Boxing Process&#34;&#39;, &#39;value&#39;: None},
  {&#39;facet&#39;: &#39;The-&#34;Facet$Food/Meat/Beef/Packaging&#34;&#39;, &#39;value&#39;: None},
  {&#39;facet&#39;: &#39;The-&#34;Facet$Food/Meat/Beef/Feeding&#34;&#39;, &#39;value&#39;: None},
  {&#39;facet&#39;: &#39;The-&#34;Facet$Food/Meat/Beef/Breed&#34;&#39;,
   &#39;value&#39;: &#39;The-&#34;Facet$Food/Meat/Beef/Breed/Wagyu/Tajima,Kobe&#34;&#39;},
  {&#39;facet&#39;: &#39;The-&#34;Facet$Food/Meat/Beef/Fat Color&#34;&#39;, &#39;value&#39;: None},
  {&#39;facet&#39;: &#39;The-&#34;Facet$Food/Meat/Beef/Brand&#34;&#39;, &#39;value&#39;: None},
  {&#39;facet&#39;: &#39;The-&#34;Facet$Food/Meat/Beef/Marbling&#34;&#39;, &#39;value&#39;: None}]}
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">smartLookup</span><span class="p">(</span><span class="n">database</span><span class="p">,</span><span class="n">searchStr</span><span class="p">):</span>
    <span class="n">selectedCatLst</span><span class="o">=</span><span class="n">lookupForString</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;catetoryTagIndex&#39;</span><span class="p">],</span><span class="n">searchStr</span><span class="p">)</span>
    <span class="n">selectedCat</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">selectedCatLst</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">serie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;productTagIndex&#39;</span><span class="p">]</span>\
                        <span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span>\
                                <span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">mainid</span><span class="p">:(</span><span class="n">mainid</span> <span class="ow">in</span> <span class="n">selectedCat</span><span class="p">))]</span>\
                        <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">serie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;productTagIndex&#39;</span><span class="p">]</span>

    <span class="n">selectedProd</span><span class="o">=</span><span class="n">lookupForString</span><span class="p">(</span><span class="n">serie</span><span class="p">,</span><span class="n">searchStr</span><span class="p">,</span><span class="n">exclude</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">tagifySerie</span><span class="p">([</span><span class="n">selectedCatLst</span><span class="p">[</span><span class="mi">0</span><span class="p">]])[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="p">{})</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">selectedCatLst</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
        <span class="n">selectedCat</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">selectedCatLst</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">selectedProdLst</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
        <span class="n">selectedProd</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">selectedProdLst</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">facetProdSerie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;productFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;prodid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)]</span>
        <span class="n">facetProdSerie</span> <span class="o">=</span> <span class="n">facetProdSerie</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;mainid&#39;</span><span class="p">),</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;facetid&#39;</span><span class="p">],</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
        <span class="n">facetProdSerie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;facetValTagIndex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">facetProdSerie</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">facetProdSerie</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">broaderThanSelectedCat</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryBroaderThanThanRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryBroaderThanThanRelation&#39;</span><span class="p">][</span><span class="s1">&#39;catid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)][</span><span class="s1">&#39;broaderid&#39;</span><span class="p">])</span>
        <span class="n">broaderOrEqualThanSelectedCat</span><span class="o">=</span><span class="n">selectedCat</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">broaderThanSelectedCat</span><span class="p">)</span>
        <span class="n">facetSerie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;catid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">broaderOrEqualThanSelectedCat</span><span class="p">)]</span>
        <span class="n">facetSerie</span> <span class="o">=</span> <span class="n">facetSerie</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;mainid&#39;</span><span class="p">),</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;facetid&#39;</span><span class="p">],</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
        <span class="n">facetSerie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;facetValTagIndex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">facetSerie</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">),</span><span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">facetSerie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;facetValTagIndex&#39;</span><span class="p">]</span>

    <span class="n">selectedFacetVal</span><span class="o">=</span><span class="n">lookupForString</span><span class="p">(</span><span class="n">facetSerie</span><span class="p">,</span><span class="n">searchStr</span><span class="p">,</span><span class="n">exclude</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">tagifySerie</span><span class="p">([</span><span class="n">selectedCatLst</span><span class="p">[</span><span class="mi">0</span><span class="p">]])[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="p">{},</span><span class="n">nmax</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">facetProdSerie</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">selectedFacetProdVal</span><span class="o">=</span><span class="n">lookupForString</span><span class="p">(</span><span class="n">facetProdSerie</span><span class="p">,</span><span class="n">searchStr</span><span class="p">,</span><span class="n">exclude</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">tagifySerie</span><span class="p">([</span><span class="n">selectedCatLst</span><span class="p">[</span><span class="mi">0</span><span class="p">]])[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="p">{},</span><span class="n">nmax</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">selectedFacetProdVal</span><span class="o">=</span><span class="p">[]</span>

    <span class="n">selectedFacetLst</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedFacetVal</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">selectedFacetLst</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedFacetVal</span><span class="p">)][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">selectedCatLst</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
            <span class="n">selectedCat</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">selectedCatLst</span><span class="p">)</span>

    <span class="n">selectedFacetProdLst</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedFacetProdVal</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">selectedFacetProdLst</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedFacetProdVal</span><span class="p">)][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
        <span class="n">selectedProdLst</span><span class="o">=</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;facetid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedFacetProdLst</span><span class="p">)][</span><span class="s1">&#39;prodid&#39;</span><span class="p">]</span>
        <span class="n">selectedProd</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">selectedProdLst</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">selectedCatLst</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productInsideCategoryRelation&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">())</span>
            <span class="n">selectedCat</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">selectedCatLst</span><span class="p">)</span>

    <span class="n">possibleFacets</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">broaderThanSelectedCat</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryBroaderThanThanRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryBroaderThanThanRelation&#39;</span><span class="p">][</span><span class="s1">&#39;catid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)][</span><span class="s1">&#39;broaderid&#39;</span><span class="p">])</span>
        <span class="n">broaderOrEqualThanSelectedCat</span><span class="o">=</span><span class="n">selectedCat</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">broaderThanSelectedCat</span><span class="p">)</span>
        <span class="n">possibleFacets</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;catid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">broaderOrEqualThanSelectedCat</span><span class="p">)][</span><span class="s1">&#39;facetid&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">facetProdSerie</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;productFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;productFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;prodid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">selectedProd</span><span class="p">)][</span><span class="s1">&#39;facetid&#39;</span><span class="p">]</span>
        <span class="n">possibleFacets</span><span class="o">=</span><span class="n">possibleFacets</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">facetProdSerie</span><span class="p">)</span>

    <span class="n">facets</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">facet</span> <span class="ow">in</span> <span class="n">possibleFacets</span><span class="p">:</span>
        <span class="n">fctvals</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">facet</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="n">database</span><span class="p">[</span><span class="s1">&#39;facetValTagIndex&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;facetValTagIndex&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">fctvals</span><span class="p">)]</span>
        <span class="n">selectedFacetVal</span><span class="o">=</span><span class="n">lookupForString</span><span class="p">(</span><span class="n">tags</span><span class="p">,</span><span class="n">searchStr</span><span class="p">,</span><span class="n">exclude</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">tagifySerie</span><span class="p">([</span><span class="n">selectedCatLst</span><span class="p">[</span><span class="mi">0</span><span class="p">]])[</span><span class="s1">&#39;tag&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedCat</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="p">{},</span><span class="n">nmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">facets</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;facet&#39;</span><span class="p">:[</span><span class="n">facet</span><span class="p">],</span> <span class="s1">&#39;value&#39;</span><span class="p">:[</span><span class="n">selectedFacetVal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selectedFacetVal</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span><span class="p">]})</span>

    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span><span class="n">selectedCatLst</span><span class="p">,</span> <span class="s1">&#39;product&#39;</span><span class="p">:</span><span class="n">selectedProd</span><span class="p">,</span> <span class="s1">&#39;facets&#39;</span><span class="p">:</span><span class="n">facets</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span><span class="n">HTML</span><span class="p">,</span><span class="n">clear_output</span>
<span class="kn">from</span> <span class="nn">flask_table</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">Col</span><span class="p">,</span> <span class="n">NestedTableCol</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">getCategoryUI</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span><span class="n">clb</span><span class="p">):</span>
    <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">category</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;The-&quot;Category$&#39;</span><span class="p">)]</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">mainCat</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mainCat</span> <span class="o">=</span> <span class="s1">&#39;The-&quot;Category$Food&quot;&#39;</span>
    <span class="n">nameMainCat</span><span class="o">=</span><span class="n">mainCat</span><span class="p">[</span><span class="n">mainCat</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
    <span class="n">curName</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="n">menu</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nameMainCat</span><span class="p">:</span>
        <span class="n">curName</span><span class="o">=</span><span class="n">curName</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">n</span> <span class="k">if</span> <span class="n">curName</span><span class="o">!=</span><span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="n">n</span>
        <span class="n">curNameIns</span> <span class="o">=</span> <span class="s1">&#39;The-&quot;Category$&#39;</span><span class="o">+</span><span class="n">curName</span><span class="o">+</span><span class="s1">&#39;&quot;&#39;</span>
        <span class="n">subIns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryHierarchy&#39;</span><span class="p">][(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryHierarchy&#39;</span><span class="p">][</span><span class="s1">&#39;super&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">curNameIns</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;categoryHierarchy&#39;</span><span class="p">][</span><span class="s1">&#39;sub&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;The-&quot;Category$&#39;</span><span class="p">)))][</span><span class="s1">&#39;sub&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">subIns</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">subNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">subIns</span> <span class="p">]</span>
        <span class="n">tobbut</span><span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButtons</span><span class="p">(</span>
            <span class="n">options</span><span class="o">=</span><span class="n">subNames</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">curName</span><span class="p">,</span>
            <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">button_style</span><span class="o">=</span><span class="s1">&#39;info&#39;</span><span class="p">,</span> <span class="c1"># &#39;success&#39;, &#39;info&#39;, &#39;warning&#39;, &#39;danger&#39; or &#39;&#39;</span>
            <span class="n">tooltips</span><span class="o">=</span><span class="n">subIns</span><span class="p">,</span>
            <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1">#     icons=[&#39;check&#39;] * 3</span>
        <span class="p">)</span>

        <span class="n">menu</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tobbut</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_value_change</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
        <span class="n">clb</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">menu</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">nameMainCat</span><span class="p">):</span>
            <span class="n">menu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="o">=</span><span class="n">nameMainCat</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">menu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">on_value_change</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">getProductUI</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">product</span><span class="p">,</span><span class="n">clb</span><span class="p">):</span>
    <span class="n">opc</span><span class="o">=</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">product</span><span class="p">]</span>
    <span class="n">opc</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">tobbut</span><span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButtons</span><span class="p">(</span>
        <span class="n">options</span><span class="o">=</span><span class="n">opc</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Product&#39;</span><span class="p">,</span>
        <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">button_style</span><span class="o">=</span><span class="s1">&#39;success&#39;</span><span class="p">,</span> <span class="c1"># &#39;success&#39;, &#39;info&#39;, &#39;warning&#39;, &#39;danger&#39; or &#39;&#39;</span>
        <span class="n">tooltips</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">product</span><span class="p">),</span>
        <span class="n">value</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">product</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">product</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="n">opc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1">#     icons=[&#39;check&#39;] * 3</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">on_value_change</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
        <span class="n">clb</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>

    <span class="n">tobbut</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">on_value_change</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tobbut</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">getFacetsUI</span><span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">facets</span><span class="p">,</span><span class="n">clb</span><span class="p">):</span>
    <span class="n">menu</span><span class="o">=</span><span class="p">[]</span>

    <span class="k">for</span> <span class="n">facetValDict</span> <span class="ow">in</span> <span class="n">facets</span><span class="p">:</span>
        <span class="n">facetIns</span> <span class="o">=</span> <span class="n">facetValDict</span><span class="p">[</span><span class="s1">&#39;facet&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">facetVal</span> <span class="o">=</span> <span class="n">facetValDict</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">facetValDict</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="n">pp</span><span class="o">=</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">][</span><span class="n">database</span><span class="p">[</span><span class="s1">&#39;valuesInsideFacetRelation&#39;</span><span class="p">][</span><span class="s1">&#39;mainid&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">facetIns</span><span class="p">]</span>
        <span class="n">facetVals</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pp</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span>
        <span class="n">facetVals</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">facetNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">facetVals</span><span class="p">]</span>
        <span class="n">tobbut</span><span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">ToggleButtons</span><span class="p">(</span>
            <span class="n">options</span><span class="o">=</span><span class="n">facetNames</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">facetIns</span><span class="p">[</span><span class="n">facetIns</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">button_style</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="c1"># &#39;success&#39;, &#39;info&#39;, &#39;warning&#39;, &#39;danger&#39; or &#39;&#39;</span>
            <span class="n">tooltips</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">facetVals</span><span class="p">),</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">facetVal</span><span class="p">[</span><span class="n">facetVal</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">facetVal</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="c1">#     icons=[&#39;check&#39;] * 3</span>
        <span class="p">)</span>
        <span class="n">menu</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tobbut</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">on_value_change</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
            <span class="n">clb</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="n">b</span><span class="o">.</span><span class="n">owner</span><span class="o">.</span><span class="n">index</span><span class="p">])</span>

        <span class="n">tobbut</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">on_value_change</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">InitValue</span> <span class="o">=</span> <span class="s1">&#39;meat cow waygu&#39;</span>

<span class="kn">import</span> <span class="nn">collections</span>

<span class="n">edit_widget</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">InitValue</span><span class="p">,</span>
                <span class="n">placeholder</span><span class="o">=</span><span class="s1">&#39;Type something&#39;</span><span class="p">,</span>
                <span class="n">disabled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;90%&#39;</span><span class="p">),</span>
                <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;description_width&#39;</span><span class="p">:</span> <span class="s1">&#39;initial&#39;</span><span class="p">}</span>
            <span class="p">)</span>


<span class="n">outoput_widget</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
<span class="n">outoput_prods_widget</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">buildTextFromUI</span><span class="p">():</span>
    <span class="n">ui</span> <span class="o">=</span> <span class="n">outoput_widget</span><span class="o">.</span><span class="n">ui</span>
    <span class="n">catui</span> <span class="o">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tb</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">tb</span> <span class="ow">in</span> <span class="n">catui</span><span class="o">.</span><span class="n">children</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tb</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">])</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ui</span><span class="o">.</span><span class="n">children</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">produi</span><span class="p">,</span><span class="n">facetui</span> <span class="o">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ui</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">produi</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">+</span><span class="n">produi</span><span class="o">.</span><span class="n">value</span>

        <span class="n">txt</span> <span class="o">=</span> <span class="n">txt</span><span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">tb</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">tb</span> <span class="ow">in</span> <span class="n">facetui</span><span class="o">.</span><span class="n">children</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">tb</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">txt</span>

<span class="k">def</span> <span class="nf">onCategoryClicked</span><span class="p">(</span><span class="n">category</span><span class="p">):</span>
    <span class="n">edit_widget</span><span class="o">.</span><span class="n">value</span><span class="o">=</span><span class="n">buildTextFromUI</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">onProductClicked</span><span class="p">(</span><span class="n">product</span><span class="p">):</span>
    <span class="n">edit_widget</span><span class="o">.</span><span class="n">value</span><span class="o">=</span><span class="n">buildTextFromUI</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">onFacetClicked</span><span class="p">(</span><span class="n">facet</span><span class="p">):</span>
    <span class="n">edit_widget</span><span class="o">.</span><span class="n">value</span><span class="o">=</span><span class="n">buildTextFromUI</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">reload</span><span class="p">(</span><span class="n">searchStr</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">outoput_widget</span><span class="p">:</span>
        <span class="n">clear_output</span><span class="p">()</span>
        <span class="n">look</span><span class="o">=</span><span class="n">smartLookup</span><span class="p">(</span><span class="n">database</span><span class="p">,</span><span class="n">searchStr</span><span class="p">)</span>

        <span class="n">catui</span><span class="o">=</span><span class="n">getCategoryUI</span><span class="p">(</span><span class="n">database</span><span class="p">,</span><span class="n">look</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">],</span><span class="n">onCategoryClicked</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">look</span><span class="p">[</span><span class="s1">&#39;product&#39;</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">produi</span><span class="o">=</span><span class="n">getProductUI</span><span class="p">(</span><span class="n">database</span><span class="p">,</span><span class="n">look</span><span class="p">[</span><span class="s1">&#39;product&#39;</span><span class="p">],</span><span class="n">onProductClicked</span><span class="p">)</span>

            <span class="n">facetui</span><span class="o">=</span><span class="n">getFacetsUI</span><span class="p">(</span><span class="n">database</span><span class="p">,</span><span class="n">look</span><span class="p">[</span><span class="s1">&#39;facets&#39;</span><span class="p">],</span><span class="n">onFacetClicked</span><span class="p">)</span>

            <span class="n">ui</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">catui</span><span class="p">,</span><span class="n">produi</span><span class="p">,</span><span class="n">facetui</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ui</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">catui</span><span class="p">])</span>

        <span class="n">outoput_widget</span><span class="o">.</span><span class="n">ui</span> <span class="o">=</span> <span class="n">ui</span>
        <span class="n">display</span><span class="p">(</span><span class="n">ui</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">onChange</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
    <span class="n">searchStr</span><span class="o">=</span><span class="n">change</span><span class="o">.</span><span class="n">new</span>
    <span class="n">reload</span><span class="p">(</span><span class="n">searchStr</span><span class="p">)</span>


<span class="n">onChange</span><span class="p">(</span><span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;new&#39;</span><span class="p">)(</span><span class="n">new</span><span class="o">=</span><span class="n">edit_widget</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="n">edit_widget</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">onChange</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cursor&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>
<span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">([</span><span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">edit_widget</span><span class="p">,</span><span class="n">outoput_widget</span><span class="p">],</span><span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s1">&#39;50%&#39;</span><span class="p">)),</span><span class="n">outoput_prods_widget</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7c27b4ad4095417ea0bafad7c4cb98aa", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {"01dd8ea17c104e099cb2b28ca5cfa6f9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_63f02cf2d0bb4ff4ac295cd44c03d9cb", "IPY_MODEL_27485837b1644caa9cb38422cf8cff63"], "layout": "IPY_MODEL_8f3feabb91dc4fa6a32ded89e6379a9a"}}, "02504c5f735144e79f14ce804f8a69f8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "<Proper-Name>"], "index": 0, "layout": "IPY_MODEL_7427e9ed80f4452c9f5398831108cb23", "style": "IPY_MODEL_96ce8b03c7d94f5dbc9a8986c3faaac4"}}, "03f20c852baa4426b35eb191fbe17109": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "0431bd12d4e64b489732072beb31877d": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "05119b65e63140aa8e8f5eb405e0edde": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_357048546e85445a8445552f8a95fa96", "IPY_MODEL_4fbf59eec3534a9cb30dec40bef2a805"], "layout": "IPY_MODEL_0431bd12d4e64b489732072beb31877d"}}, "07b1de88566046ab843c6b33c1a33482": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "0863b06a5db04e19b02c0101e070166b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_87f808117765469bb4603b73751a6a15", "placeholder": "Type something", "style": "IPY_MODEL_27d4ccc5660a4ae490a8e0096edd042e"}}, "0d97acce21c9452c9d8575bcb79f645a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "0f491f241a074dd086ce967574c7564a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "0fa3127e8f434f4fab267ef1bb90de06": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "10b5d6c1da0b479989af684ca50f5b6c": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "11ba7f6f247d4c1e917e065217c43d7f": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "146cedc816244442872a3cd1088e4757": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "156e6561fd514b3b81f68bd3a02ed225": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "17a5280aae154d7f9ede482d7c947e78": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["anything", "every", "every-single-thing", "if", "no", "nothing", "something", "the", "the-one-and-only", "X", "Earth", "Sun", "Mercury", "Venus", "Moon", "Mars", "Phobos", "Deimos", "Jupiter", "Metis", "Adrastea", "Thebe", "Io", "Europa", "Ganymede", "Callisto", "Themisto", "Leda", "Himalia", "Lysithea", "Elara", "Ananke", "Carme", "Pasiphae", "Sinope", "Iocaste", "Harpalyke", "Praxidike", "Taygete", "Chaldene", "Kalyke", "Callirrhoe", "Megaclite", "Isonoe", "Erinome", "Saturn", "Pan", "Atlas", "Prometheus", "Pandora", "Epimetheus", "Janus", "Mimas", "Enceladus", "Tethys", "Telesto", "Calypso", "Dione", "Helene", "Rhea", "Titan", "Hyperion", "Iapetus", "Phoebe", "Uranus", "Cordelia", "Ophelia", "Bianca", "Cressida", "Desdemona", "Juliet", "Portia", "Rosalind", "Belinda", "Puck", "Miranda", "Ariel", "Umbriel", "Titania", "Oberon", "Caliban", "Stephano", "Sycorax", "Prospero", "Setebos", "Trinculo", "Neptune", "Naiad", "Thalassa", "Despina", "Galatea", "Larissa", "Proteus", "Triton", "Nereid", "Pluto", "Charon", "Nix", "Hydra", "Amalthea"], "index": 0, "layout": "IPY_MODEL_11ba7f6f247d4c1e917e065217c43d7f", "style": "IPY_MODEL_2378297d9fda40bdba8b8c5d8a3cadbb"}}, "1882b1f7384746fe906cc2d3f35f6093": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "1962eb3b21ff46b09fe3ebd278c483e1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"index": null, "layout": "IPY_MODEL_10b5d6c1da0b479989af684ca50f5b6c", "style": "IPY_MODEL_8b15c1e57d91422d8831de1cd9b8298b"}}, "1a8d3490ef604750a57e35d2bbf44ed0": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "1b29e7d64c6749b7badbbaf6c3b1824b": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "1e84c4d0b0fc48e4ba60110cc7253cf1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "1f622650d0cc4319946101c4e5648568": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_49756fc1ec70403290b16d6f86afaa03", "IPY_MODEL_edcefb046bdd4b62bf4c250d1b2509e8"], "layout": "IPY_MODEL_1882b1f7384746fe906cc2d3f35f6093"}}, "2038c15743494d1eaa2416bd47a5175d": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "229067d8b33e4508a48b303b11b3aea1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_a29ae851e4cc4a32bed4156b60241cb7", "placeholder": "Type something", "style": "IPY_MODEL_c507c8f3cae74d71a1ade6722117c7f2"}}, "2378297d9fda40bdba8b8c5d8a3cadbb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "25e8f53219ac46f1b1c5d152ab14c970": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_0d97acce21c9452c9d8575bcb79f645a", "placeholder": "Type something", "style": "IPY_MODEL_1a8d3490ef604750a57e35d2bbf44ed0", "value": "Every "}}, "262b851bcdf44184b018b530691bc17c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_9becb92ef87944febe3e1a48b1cc391b", "IPY_MODEL_4a159d4745c44efc86ab37ff55c47ed1"], "layout": "IPY_MODEL_2aee630301f944d1ba9b0e8b54b8f052"}}, "26ec35b9d14f46a59e9be848e34f992f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_229067d8b33e4508a48b303b11b3aea1", "IPY_MODEL_5c55f36457a64fc78eb4d6fd59e96f5b"], "layout": "IPY_MODEL_a0f35c44d9724b4689b84fca6bbbe456"}}, "27485837b1644caa9cb38422cf8cff63": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["<Proper-Name>"], "index": 0, "layout": "IPY_MODEL_c3e97b7c896f45ec9c5e0df8001ce401", "style": "IPY_MODEL_b433f984bab24d8c8d1e58332b2875b4"}}, "27d4ccc5660a4ae490a8e0096edd042e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "2aee630301f944d1ba9b0e8b54b8f052": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "2b5cda67a4104b7bafe0c359c422d0ae": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "2d1c435aa2974d01a737190c751be926": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "2d70ba83e75d47609df5f6e54bb7f256": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "2eca3e5112924df4b9d248e5cb981c6b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_872fa8a080cc42e4a76901304c089c7d", "IPY_MODEL_f666d81b663942b7827f50d6392b3d5d"], "layout": "IPY_MODEL_c02914c289a2424b92b5e9ceb2647665"}}, "3171ab59e8c4484cb10addb75aa2746a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "331d92391d4a4625aff8ef69d6852f21": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_c673637848af4f72a495cebb6845479b", "IPY_MODEL_02504c5f735144e79f14ce804f8a69f8"], "layout": "IPY_MODEL_e8aa0bc57fca4700a03e4addf1cf8e16"}}, "33df909178f9486eb145c076f3a403cb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "If", "No", "Nothing", "Something", "The", "X", "Earth", "Sun", "Mercury", "Venus", "Moon", "Mars", "Phobos", "Deimos", "Jupiter", "Metis", "Adrastea", "Thebe", "Io", "Europa", "Ganymede", "Callisto", "Themisto", "Leda", "Himalia", "Lysithea", "Elara", "Ananke", "Carme", "Pasiphae", "Sinope", "Iocaste", "Harpalyke", "Praxidike", "Taygete", "Chaldene", "Kalyke", "Callirrhoe", "Megaclite", "Isonoe", "Erinome", "Saturn", "Pan", "Atlas", "Prometheus", "Pandora", "Epimetheus", "Janus", "Mimas", "Enceladus", "Tethys", "Telesto", "Calypso", "Dione", "Helene", "Rhea", "Titan", "Hyperion", "Iapetus", "Phoebe", "Uranus", "Cordelia", "Ophelia", "Bianca", "Cressida", "Desdemona", "Juliet", "Portia", "Rosalind", "Belinda", "Puck", "Miranda", "Ariel", "Umbriel", "Titania", "Oberon", "Caliban", "Stephano", "Sycorax", "Prospero", "Setebos", "Trinculo", "Neptune", "Naiad", "Thalassa", "Despina", "Galatea", "Larissa", "Proteus", "Triton", "Nereid", "Pluto", "Charon", "Nix", "Hydra", "Amalthea"], "index": 0, "layout": "IPY_MODEL_61e828d0db6c4e38bf18f5c20cb2c79a", "style": "IPY_MODEL_58b0f3f8d0ec45cd99e980faeb1689ff"}}, "357048546e85445a8445552f8a95fa96": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_ecab57e671f54f66971e1fd10690ce1a", "placeholder": "Type something", "style": "IPY_MODEL_1e84c4d0b0fc48e4ba60110cc7253cf1"}}, "35be1247c81c4ebf80335e363b7885f7": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "3760fd0f4dee41af9892335831d6ddf0": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "3886172942f04f25b8cb3402a77be8b6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_4c2040ca1cc742a2a66eeb6e97d4e91f", "IPY_MODEL_5fbc6e40bfae4c6bacc15eb0018d342a"], "layout": "IPY_MODEL_6ddc5ad410bf4dd88250e8701603d574"}}, "39f209f29b7e4f28bd86649c3caa6597": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "If", "No", "Nothing", "Something", "The", "X", "Earth", "Sun", "Mercury", "Venus", "Moon", "Mars", "Phobos", "Deimos", "Jupiter", "Metis", "Adrastea", "Thebe", "Io", "Europa", "Ganymede", "Callisto", "Themisto", "Leda", "Himalia", "Lysithea", "Elara", "Ananke", "Carme", "Pasiphae", "Sinope", "Iocaste", "Harpalyke", "Praxidike", "Taygete", "Chaldene", "Kalyke", "Callirrhoe", "Megaclite", "Isonoe", "Erinome", "Saturn", "Pan", "Atlas", "Prometheus", "Pandora", "Epimetheus", "Janus", "Mimas", "Enceladus", "Tethys", "Telesto", "Calypso", "Dione", "Helene", "Rhea", "Titan", "Hyperion", "Iapetus", "Phoebe", "Uranus", "Cordelia", "Ophelia", "Bianca", "Cressida", "Desdemona", "Juliet", "Portia", "Rosalind", "Belinda", "Puck", "Miranda", "Ariel", "Umbriel", "Titania", "Oberon", "Caliban", "Stephano", "Sycorax", "Prospero", "Setebos", "Trinculo", "Neptune", "Naiad", "Thalassa", "Despina", "Galatea", "Larissa", "Proteus", "Triton", "Nereid", "Pluto", "Charon", "Nix", "Hydra", "Amalthea"], "index": 0, "layout": "IPY_MODEL_7a743dfe2072422c8a82d2edafe415c2", "style": "IPY_MODEL_cf91d29144c6428dbe4a57ec5daa0559"}}, "3fda814c78254ee0943a98907b19faa0": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "40139c5f94da4ac6850a7ab19e1b8ff0": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_c8aff3b1b9bf42a1b693314414158561", "placeholder": "Type something", "style": "IPY_MODEL_434beb56716b4d4199cd9b30d890b5dc", "value": "Every star is a planet"}}, "434beb56716b4d4199cd9b30d890b5dc": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "43a0b336d395497ab77f3dae355f7d39": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_986416b6ed2a4771a8c7301ca69dc7e7", "placeholder": "Type something", "style": "IPY_MODEL_6bb9669a422f43208d51de2f1359c3af"}}, "43ef6f0db7014da7b93efc69ee461a11": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "4411c87e5835477993336686f013a99e": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "4678d96dc44c410aa9fb029a5e388cd7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_dbc8edf5ad284155ad80d4d4338dec9c", "placeholder": "Type something", "style": "IPY_MODEL_7e7e2897f7c8463089aa3696b747f1ea", "value": "Every star is a planet "}}, "47198986ae3d4937aa99d8ec56f583bb": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "49756fc1ec70403290b16d6f86afaa03": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_ad8baf21d16f45e481c64c95f0202452", "placeholder": "Type something", "style": "IPY_MODEL_a6ef94d5bc7d496793663a5b53965d35", "value": "E"}}, "4a140e21e6e44a49b538dfb1007385a6": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "4a159d4745c44efc86ab37ff55c47ed1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "If", "No", "Nothing", "Something", "The", "X", "Earth", "Sun", "Mercury", "Venus", "Moon", "Mars", "Phobos", "Deimos", "Jupiter", "Metis", "Adrastea", "Thebe", "Io", "Europa", "Ganymede", "Callisto", "Themisto", "Leda", "Himalia", "Lysithea", "Elara", "Ananke", "Carme", "Pasiphae", "Sinope", "Iocaste", "Harpalyke", "Praxidike", "Taygete", "Chaldene", "Kalyke", "Callirrhoe", "Megaclite", "Isonoe", "Erinome", "Saturn", "Pan", "Atlas", "Prometheus", "Pandora", "Epimetheus", "Janus", "Mimas", "Enceladus", "Tethys", "Telesto", "Calypso", "Dione", "Helene", "Rhea", "Titan", "Hyperion", "Iapetus", "Phoebe", "Uranus", "Cordelia", "Ophelia", "Bianca", "Cressida", "Desdemona", "Juliet", "Portia", "Rosalind", "Belinda", "Puck", "Miranda", "Ariel", "Umbriel", "Titania", "Oberon", "Caliban", "Stephano", "Sycorax", "Prospero", "Setebos", "Trinculo", "Neptune", "Naiad", "Thalassa", "Despina", "Galatea", "Larissa", "Proteus", "Triton", "Nereid", "Pluto", "Charon", "Nix", "Hydra", "Amalthea"], "index": 0, "layout": "IPY_MODEL_def9645218414232a631e7e14daf7797", "style": "IPY_MODEL_60e4a579bae64045929bf2da1e604b93"}}, "4b25f4a8157f451fa1817961be95502e": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "4bbb46a899174d11ba09d829471358c0": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_43a0b336d395497ab77f3dae355f7d39", "IPY_MODEL_39f209f29b7e4f28bd86649c3caa6597"], "layout": "IPY_MODEL_2d70ba83e75d47609df5f6e54bb7f256"}}, "4c2040ca1cc742a2a66eeb6e97d4e91f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_9ce656bbeccc4f99bbd2a3bfd7b8d112", "placeholder": "Type something", "style": "IPY_MODEL_43ef6f0db7014da7b93efc69ee461a11"}}, "4c98f214f5334ab282e817c818e710fb": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "4e48202a1f894da8947aff591b752a1f": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "4f50e25800c94195836ab99b1cd79611": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "4fbf59eec3534a9cb30dec40bef2a805": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "If", "No", "Nothing", "Something", "The", "X", "Earth", "Sun", "Mercury", "Venus", "Moon", "Mars", "Phobos", "Deimos", "Jupiter", "Metis", "Adrastea", "Thebe", "Io", "Europa", "Ganymede", "Callisto", "Themisto", "Leda", "Himalia", "Lysithea", "Elara", "Ananke", "Carme", "Pasiphae", "Sinope", "Iocaste", "Harpalyke", "Praxidike", "Taygete", "Chaldene", "Kalyke", "Callirrhoe", "Megaclite", "Isonoe", "Erinome", "Saturn", "Pan", "Atlas", "Prometheus", "Pandora", "Epimetheus", "Janus", "Mimas", "Enceladus", "Tethys", "Telesto", "Calypso", "Dione", "Helene", "Rhea", "Titan", "Hyperion", "Iapetus", "Phoebe", "Uranus", "Cordelia", "Ophelia", "Bianca", "Cressida", "Desdemona", "Juliet", "Portia", "Rosalind", "Belinda", "Puck", "Miranda", "Ariel", "Umbriel", "Titania", "Oberon", "Caliban", "Stephano", "Sycorax", "Prospero", "Setebos", "Trinculo", "Neptune", "Naiad", "Thalassa", "Despina", "Galatea", "Larissa", "Proteus", "Triton", "Nereid", "Pluto", "Charon", "Nix", "Hydra", "Amalthea"], "index": 0, "layout": "IPY_MODEL_c74402ccc47d43d2a881fc20d0adf49b", "style": "IPY_MODEL_a81ffce7dd474b2b8a0d5499e16aa5a5"}}, "509117a9cac846029ddc07619cf2382f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_4678d96dc44c410aa9fb029a5e388cd7", "IPY_MODEL_5f062eb8abce43d1a0f2d63aff740869"], "layout": "IPY_MODEL_b8ba4cbbbe854828bc44880fe533a7e9"}}, "58b0f3f8d0ec45cd99e980faeb1689ff": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "5a3e9e4eeeb748e3bffa4e381620d4d3": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_7b95430ed3c04f2e98910ab675871bbc", "placeholder": "Type something", "style": "IPY_MODEL_effc1cd5acee4ca4a3b642f9ab222f19"}}, "5ac79de8e7e24fd78175c7c5d6ebeae8": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "5b83ab96d2704bd0904ea508ed7c7d14": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "5c55f36457a64fc78eb4d6fd59e96f5b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "If", "No", "Nothing", "Something", "The", "X", "Earth", "Sun", "Mercury", "Venus", "Moon", "Mars", "Phobos", "Deimos", "Jupiter", "Metis", "Adrastea", "Thebe", "Io", "Europa", "Ganymede", "Callisto", "Themisto", "Leda", "Himalia", "Lysithea", "Elara", "Ananke", "Carme", "Pasiphae", "Sinope", "Iocaste", "Harpalyke", "Praxidike", "Taygete", "Chaldene", "Kalyke", "Callirrhoe", "Megaclite", "Isonoe", "Erinome", "Saturn", "Pan", "Atlas", "Prometheus", "Pandora", "Epimetheus", "Janus", "Mimas", "Enceladus", "Tethys", "Telesto", "Calypso", "Dione", "Helene", "Rhea", "Titan", "Hyperion", "Iapetus", "Phoebe", "Uranus", "Cordelia", "Ophelia", "Bianca", "Cressida", "Desdemona", "Juliet", "Portia", "Rosalind", "Belinda", "Puck", "Miranda", "Ariel", "Umbriel", "Titania", "Oberon", "Caliban", "Stephano", "Sycorax", "Prospero", "Setebos", "Trinculo", "Neptune", "Naiad", "Thalassa", "Despina", "Galatea", "Larissa", "Proteus", "Triton", "Nereid", "Pluto", "Charon", "Nix", "Hydra", "Amalthea"], "index": 0, "layout": "IPY_MODEL_47198986ae3d4937aa99d8ec56f583bb", "style": "IPY_MODEL_82500fee41e047828578dea9be6a7577"}}, "5d7f775b3d6a4e509b88b7cf81bc36d4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "<Proper-Name>"], "index": 0, "layout": "IPY_MODEL_35be1247c81c4ebf80335e363b7885f7", "style": "IPY_MODEL_e9c17ff64d474cb8a7b36b727ba6f3e6"}}, "5f062eb8abce43d1a0f2d63aff740869": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["(", "and", "and-or", "that", "."], "index": 0, "layout": "IPY_MODEL_e63b4521bbc84265882b4ca9931f891f", "style": "IPY_MODEL_6d9d90143620416b85d40ed4a5b987ee"}}, "5fbc6e40bfae4c6bacc15eb0018d342a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "If", "No", "Nothing", "Something", "The", "X", "Earth", "Sun", "Mercury", "Venus", "Moon", "Mars", "Phobos", "Deimos", "Jupiter", "Metis", "Adrastea", "Thebe", "Io", "Europa", "Ganymede", "Callisto", "Themisto", "Leda", "Himalia", "Lysithea", "Elara", "Ananke", "Carme", "Pasiphae", "Sinope", "Iocaste", "Harpalyke", "Praxidike", "Taygete", "Chaldene", "Kalyke", "Callirrhoe", "Megaclite", "Isonoe", "Erinome", "Saturn", "Pan", "Atlas", "Prometheus", "Pandora", "Epimetheus", "Janus", "Mimas", "Enceladus", "Tethys", "Telesto", "Calypso", "Dione", "Helene", "Rhea", "Titan", "Hyperion", "Iapetus", "Phoebe", "Uranus", "Cordelia", "Ophelia", "Bianca", "Cressida", "Desdemona", "Juliet", "Portia", "Rosalind", "Belinda", "Puck", "Miranda", "Ariel", "Umbriel", "Titania", "Oberon", "Caliban", "Stephano", "Sycorax", "Prospero", "Setebos", "Trinculo", "Neptune", "Naiad", "Thalassa", "Despina", "Galatea", "Larissa", "Proteus", "Triton", "Nereid", "Pluto", "Charon", "Nix", "Hydra", "Amalthea"], "index": 0, "layout": "IPY_MODEL_5ac79de8e7e24fd78175c7c5d6ebeae8", "style": "IPY_MODEL_b1c8b5e0dd214c72b7227379b44dae73"}}, "60561567f7214b8ca5da53f789698fa5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "60e4a579bae64045929bf2da1e604b93": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "6138e9766e7348adaebff595f0e1ba2d": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "61bc818a123d46a7be565b3f339de3f1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "61e828d0db6c4e38bf18f5c20cb2c79a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "633919b41021464daa5a3172b43bd94e": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_7686a318c04c41b8b8cb420070aa2d2c", "IPY_MODEL_bab1d2de7715464d968b836fc71ede6c"], "layout": "IPY_MODEL_984f3b94b3814ef49927b98207ef1513"}}, "6356a9fc31784b789fde072db2f3bab1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "63d7d7193dd048d3b0c631aa9bb3aef9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "If", "No", "Nothing", "Something", "The", "X", "Earth", "Sun", "Mercury", "Venus", "Moon", "Mars", "Phobos", "Deimos", "Jupiter", "Metis", "Adrastea", "Thebe", "Io", "Europa", "Ganymede", "Callisto", "Themisto", "Leda", "Himalia", "Lysithea", "Elara", "Ananke", "Carme", "Pasiphae", "Sinope", "Iocaste", "Harpalyke", "Praxidike", "Taygete", "Chaldene", "Kalyke", "Callirrhoe", "Megaclite", "Isonoe", "Erinome", "Saturn", "Pan", "Atlas", "Prometheus", "Pandora", "Epimetheus", "Janus", "Mimas", "Enceladus", "Tethys", "Telesto", "Calypso", "Dione", "Helene", "Rhea", "Titan", "Hyperion", "Iapetus", "Phoebe", "Uranus", "Cordelia", "Ophelia", "Bianca", "Cressida", "Desdemona", "Juliet", "Portia", "Rosalind", "Belinda", "Puck", "Miranda", "Ariel", "Umbriel", "Titania", "Oberon", "Caliban", "Stephano", "Sycorax", "Prospero", "Setebos", "Trinculo", "Neptune", "Naiad", "Thalassa", "Despina", "Galatea", "Larissa", "Proteus", "Triton", "Nereid", "Pluto", "Charon", "Nix", "Hydra", "Amalthea"], "index": 0, "layout": "IPY_MODEL_6a33f946ac2449938ca836e6151c6ee3", "style": "IPY_MODEL_f9018487e15e49d58270a9f1a03d38cd"}}, "63f02cf2d0bb4ff4ac295cd44c03d9cb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_0fa3127e8f434f4fab267ef1bb90de06", "placeholder": "Type something", "style": "IPY_MODEL_ab0608eab3864984916f218d6ba61153", "value": "Eeve"}}, "670b0b974a3b469b8c4487be718093a3": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "6a33f946ac2449938ca836e6151c6ee3": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "6bb9669a422f43208d51de2f1359c3af": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "6bc4339bc1a24bf493c0457a66bc1eac": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_9f68c3ea2a0940608fe3faafe2d1b98f", "placeholder": "Type something", "style": "IPY_MODEL_ab1ee7bb23d9430e9067a171a00fbeb5"}}, "6d5a6cdbe9cb43fe83071bd249856e10": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "6d9d90143620416b85d40ed4a5b987ee": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "6ddc5ad410bf4dd88250e8701603d574": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "70acc055e790487db3cd53d2da1ced23": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_d00cf48d694847a1b5fe0726650c8299", "placeholder": "Type something", "style": "IPY_MODEL_759134b9a1654ee7ac05201630bc8f2a", "value": "Every star is a planet"}}, "714829b2d35c40a6a48be1428dc0f82e": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "71723ae9ee0b4d20bf9d12b3a93b977b": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "72a6ef3bac3f4d979507a3e74dfe0f7b": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "7427e9ed80f4452c9f5398831108cb23": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "74718af4f7ef46bfa1cfbb67a653de95": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "759134b9a1654ee7ac05201630bc8f2a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "7686a318c04c41b8b8cb420070aa2d2c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_1b29e7d64c6749b7badbbaf6c3b1824b", "placeholder": "Type something", "style": "IPY_MODEL_9c57e13750b941c4b0e314119c156a9a", "value": "E"}}, "77093bfd117b4fca9070d892b0c1c614": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_6bc4339bc1a24bf493c0457a66bc1eac", "IPY_MODEL_e92e503d2522413eb840d3c6c02d66b6"], "layout": "IPY_MODEL_eb50cbc111ff4db291113ebc02b26bb5"}}, "7a743dfe2072422c8a82d2edafe415c2": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "7b95430ed3c04f2e98910ab675871bbc": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "7c08ef9704534780a6653563e8a2b90c": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "7c42f9c6f5bb488ba1a874666403934c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_70acc055e790487db3cd53d2da1ced23", "IPY_MODEL_e5c5fa35e5814ec4be7ebb41298c366c"], "layout": "IPY_MODEL_a000e5ca84ff4a048f2104679c8effb4"}}, "7c68f2a7677843ed853d9c837410624e": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "7e7e2897f7c8463089aa3696b747f1ea": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "7e9969bc470a4b349a5618f9c7e801b5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_3760fd0f4dee41af9892335831d6ddf0", "placeholder": "Type something", "style": "IPY_MODEL_dcc96dd7fe7b4f45848b1fe85b133979"}}, "7ed4b2ff9b204bfca83354b659fb72f2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "If", "No", "Nothing", "Something", "The", "X", "Earth", "Sun", "Mercury", "Venus", "Moon", "Mars", "Phobos", "Deimos", "Jupiter", "Metis", "Adrastea", "Thebe", "Io", "Europa", "Ganymede", "Callisto", "Themisto", "Leda", "Himalia", "Lysithea", "Elara", "Ananke", "Carme", "Pasiphae", "Sinope", "Iocaste", "Harpalyke", "Praxidike", "Taygete", "Chaldene", "Kalyke", "Callirrhoe", "Megaclite", "Isonoe", "Erinome", "Saturn", "Pan", "Atlas", "Prometheus", "Pandora", "Epimetheus", "Janus", "Mimas", "Enceladus", "Tethys", "Telesto", "Calypso", "Dione", "Helene", "Rhea", "Titan", "Hyperion", "Iapetus", "Phoebe", "Uranus", "Cordelia", "Ophelia", "Bianca", "Cressida", "Desdemona", "Juliet", "Portia", "Rosalind", "Belinda", "Puck", "Miranda", "Ariel", "Umbriel", "Titania", "Oberon", "Caliban", "Stephano", "Sycorax", "Prospero", "Setebos", "Trinculo", "Neptune", "Naiad", "Thalassa", "Despina", "Galatea", "Larissa", "Proteus", "Triton", "Nereid", "Pluto", "Charon", "Nix", "Hydra", "Amalthea"], "index": 0, "layout": "IPY_MODEL_07b1de88566046ab843c6b33c1a33482", "style": "IPY_MODEL_812a3a3fbe474dd583e729911e1b10e6"}}, "7fc6db8682174154a0ef82f6848ea03b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "Earth", "Europa", "Elara", "Erinome", "Epimetheus", "Enceladus"], "index": 0, "layout": "IPY_MODEL_7c68f2a7677843ed853d9c837410624e", "style": "IPY_MODEL_e125bdbf129e4376876f5aeca3c0ea92"}}, "7fe965150bed4eb180d11786935cb440": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_9da4d1aff1e6464aa9311faef7cc5c60", "IPY_MODEL_5d7f775b3d6a4e509b88b7cf81bc36d4"], "layout": "IPY_MODEL_f373c60a696749b18ccc965167b9dc58"}}, "812a3a3fbe474dd583e729911e1b10e6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "82500fee41e047828578dea9be6a7577": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "827c1a25b27c41f29c095af649333a88": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "8683b482c56c4e7c8460dadf37432261": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_4f50e25800c94195836ab99b1cd79611", "placeholder": "Type something", "style": "IPY_MODEL_ff2dcbb693dc40c88d71a2781e826073", "value": "E"}}, "872fa8a080cc42e4a76901304c089c7d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_97feb22d451e4eceb4d4dacfe34cd9ea", "placeholder": "Type something", "style": "IPY_MODEL_6d5a6cdbe9cb43fe83071bd249856e10", "value": "Every star can be a star. "}}, "87f808117765469bb4603b73751a6a15": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "8a99efb08cc9407594d0446e16d39c63": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "8b15c1e57d91422d8831de1cd9b8298b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "8f3feabb91dc4fa6a32ded89e6379a9a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "8f579e93d2b24c08929e7bf35ff5af72": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "96ce8b03c7d94f5dbc9a8986c3faaac4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "97feb22d451e4eceb4d4dacfe34cd9ea": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "984f3b94b3814ef49927b98207ef1513": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "986416b6ed2a4771a8c7301ca69dc7e7": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "9becb92ef87944febe3e1a48b1cc391b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_74718af4f7ef46bfa1cfbb67a653de95", "placeholder": "Type something", "style": "IPY_MODEL_d1f3732d476648449aa260a649c14ee1"}}, "9c57e13750b941c4b0e314119c156a9a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "9cd0e0a310044843b7e34d6c79ba3b41": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "9ce656bbeccc4f99bbd2a3bfd7b8d112": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "9cedf3e89f9040a38960c0d20281db6f": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "If", "No", "Nothing", "Something", "The", "X", "Earth", "Sun", "Mercury", "Venus", "Moon", "Mars", "Phobos", "Deimos", "Jupiter", "Metis", "Adrastea", "Thebe", "Io", "Europa", "Ganymede", "Callisto", "Themisto", "Leda", "Himalia", "Lysithea", "Elara", "Ananke", "Carme", "Pasiphae", "Sinope", "Iocaste", "Harpalyke", "Praxidike", "Taygete", "Chaldene", "Kalyke", "Callirrhoe", "Megaclite", "Isonoe", "Erinome", "Saturn", "Pan", "Atlas", "Prometheus", "Pandora", "Epimetheus", "Janus", "Mimas", "Enceladus", "Tethys", "Telesto", "Calypso", "Dione", "Helene", "Rhea", "Titan", "Hyperion", "Iapetus", "Phoebe", "Uranus", "Cordelia", "Ophelia", "Bianca", "Cressida", "Desdemona", "Juliet", "Portia", "Rosalind", "Belinda", "Puck", "Miranda", "Ariel", "Umbriel", "Titania", "Oberon", "Caliban", "Stephano", "Sycorax", "Prospero", "Setebos", "Trinculo", "Neptune", "Naiad", "Thalassa", "Despina", "Galatea", "Larissa", "Proteus", "Triton", "Nereid", "Pluto", "Charon", "Nix", "Hydra", "Amalthea"], "index": 0, "layout": "IPY_MODEL_0f491f241a074dd086ce967574c7564a", "style": "IPY_MODEL_827c1a25b27c41f29c095af649333a88"}}, "9d7c6548c6044ceabebdf034e9648bb9": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_72a6ef3bac3f4d979507a3e74dfe0f7b", "placeholder": "Type something", "style": "IPY_MODEL_03f20c852baa4426b35eb191fbe17109", "value": "E"}}, "9da4d1aff1e6464aa9311faef7cc5c60": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_4b25f4a8157f451fa1817961be95502e", "placeholder": "Type something", "style": "IPY_MODEL_8f579e93d2b24c08929e7bf35ff5af72", "value": "Ev"}}, "9e22a766a7194b2cbe9e9a2ef043ebae": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "Earth", "Europa", "Elara", "Erinome", "Epimetheus", "Enceladus"], "index": 0, "layout": "IPY_MODEL_71723ae9ee0b4d20bf9d12b3a93b977b", "style": "IPY_MODEL_8a99efb08cc9407594d0446e16d39c63"}}, "9f68c3ea2a0940608fe3faafe2d1b98f": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "a000e5ca84ff4a048f2104679c8effb4": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "a0f35c44d9724b4689b84fca6bbbe456": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "a1febd42296a44eea5027b5e1d7954d1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_9d7c6548c6044ceabebdf034e9648bb9", "IPY_MODEL_7fc6db8682174154a0ef82f6848ea03b"], "layout": "IPY_MODEL_cead18f22be341a88be462082c2b01b8"}}, "a29ae851e4cc4a32bed4156b60241cb7": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "a346f86788e745bdbd9333012363ebdb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_0863b06a5db04e19b02c0101e070166b", "IPY_MODEL_63d7d7193dd048d3b0c631aa9bb3aef9"], "layout": "IPY_MODEL_af9dac3a4ba44fc2888c76365f42aafe"}}, "a6ef94d5bc7d496793663a5b53965d35": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "a81ffce7dd474b2b8a0d5499e16aa5a5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "a8504e35e224412596ff0f6910e3a1d5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_d8df86840e0d40109ffe6ac511c1fcfc", "IPY_MODEL_c8e0cb62f5c94382b5726d90c56648d2"], "layout": "IPY_MODEL_5b83ab96d2704bd0904ea508ed7c7d14"}}, "a896ab34ae0b4978b58ddd9fd5f15480": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_8683b482c56c4e7c8460dadf37432261", "IPY_MODEL_9e22a766a7194b2cbe9e9a2ef043ebae"], "layout": "IPY_MODEL_4411c87e5835477993336686f013a99e"}}, "ab0608eab3864984916f218d6ba61153": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "ab1ee7bb23d9430e9067a171a00fbeb5": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "ad5709432b7a48768706391da99fb38d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_40139c5f94da4ac6850a7ab19e1b8ff0", "IPY_MODEL_1962eb3b21ff46b09fe3ebd278c483e1"], "layout": "IPY_MODEL_f616b5d57c97428e8373c2aaadcde8fa"}}, "ad8baf21d16f45e481c64c95f0202452": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "af185ffaf74340589c2c9d5a49812fcb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "af9dac3a4ba44fc2888c76365f42aafe": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "b1c8b5e0dd214c72b7227379b44dae73": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "b433f984bab24d8c8d1e58332b2875b4": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "b6c8e30601054ef7a0cb6044e7b1f752": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_3171ab59e8c4484cb10addb75aa2746a", "placeholder": "Type something", "style": "IPY_MODEL_af185ffaf74340589c2c9d5a49812fcb"}}, "b88b6fed648b4ed4ad47760d28ada506": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_5a3e9e4eeeb748e3bffa4e381620d4d3", "IPY_MODEL_33df909178f9486eb145c076f3a403cb"], "layout": "IPY_MODEL_6138e9766e7348adaebff595f0e1ba2d"}}, "b8ba4cbbbe854828bc44880fe533a7e9": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "bab1d2de7715464d968b836fc71ede6c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "Earth", "Europa", "Elara", "Erinome", "Epimetheus", "Enceladus"], "index": 0, "layout": "IPY_MODEL_f69cf8e7ab3943d681224b303529eba4", "style": "IPY_MODEL_fe4cbd51f6414bef86564bf189f8b4ba"}}, "bae6e5d9fa6d49108f230fb4af681d0a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "c02914c289a2424b92b5e9ceb2647665": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "c31e25ba0d0449f6965c0bb06d50b452": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "c3e97b7c896f45ec9c5e0df8001ce401": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "c507c8f3cae74d71a1ade6722117c7f2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "c673637848af4f72a495cebb6845479b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_714829b2d35c40a6a48be1428dc0f82e", "placeholder": "Type something", "style": "IPY_MODEL_156e6561fd514b3b81f68bd3a02ed225", "value": "Every"}}, "c74402ccc47d43d2a881fc20d0adf49b": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "c8aff3b1b9bf42a1b693314414158561": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "c8e0cb62f5c94382b5726d90c56648d2": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "If", "No", "Nothing", "Something", "The", "X", "Earth", "Sun", "Mercury", "Venus", "Moon", "Mars", "Phobos", "Deimos", "Jupiter", "Metis", "Adrastea", "Thebe", "Io", "Europa", "Ganymede", "Callisto", "Themisto", "Leda", "Himalia", "Lysithea", "Elara", "Ananke", "Carme", "Pasiphae", "Sinope", "Iocaste", "Harpalyke", "Praxidike", "Taygete", "Chaldene", "Kalyke", "Callirrhoe", "Megaclite", "Isonoe", "Erinome", "Saturn", "Pan", "Atlas", "Prometheus", "Pandora", "Epimetheus", "Janus", "Mimas", "Enceladus", "Tethys", "Telesto", "Calypso", "Dione", "Helene", "Rhea", "Titan", "Hyperion", "Iapetus", "Phoebe", "Uranus", "Cordelia", "Ophelia", "Bianca", "Cressida", "Desdemona", "Juliet", "Portia", "Rosalind", "Belinda", "Puck", "Miranda", "Ariel", "Umbriel", "Titania", "Oberon", "Caliban", "Stephano", "Sycorax", "Prospero", "Setebos", "Trinculo", "Neptune", "Naiad", "Thalassa", "Despina", "Galatea", "Larissa", "Proteus", "Triton", "Nereid", "Pluto", "Charon", "Nix", "Hydra", "Amalthea"], "index": 0, "layout": "IPY_MODEL_7c08ef9704534780a6653563e8a2b90c", "style": "IPY_MODEL_60561567f7214b8ca5da53f789698fa5"}}, "cc3947b6b03c4a7dab21028df9a6dc6a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "cead18f22be341a88be462082c2b01b8": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "cf91d29144c6428dbe4a57ec5daa0559": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "d00cf48d694847a1b5fe0726650c8299": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "d1f3732d476648449aa260a649c14ee1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "d348b25f42564a3a80f6f5347ff21c22": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_25e8f53219ac46f1b1c5d152ab14c970", "IPY_MODEL_7ed4b2ff9b204bfca83354b659fb72f2"], "layout": "IPY_MODEL_e6d28adbae1d4f36a73052c6b943813d"}}, "d47c504afff545ed8fe20e72c554993d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "If", "No", "Nothing", "Something", "The", "X", "Earth", "Sun", "Mercury", "Venus", "Moon", "Mars", "Phobos", "Deimos", "Jupiter", "Metis", "Adrastea", "Thebe", "Io", "Europa", "Ganymede", "Callisto", "Themisto", "Leda", "Himalia", "Lysithea", "Elara", "Ananke", "Carme", "Pasiphae", "Sinope", "Iocaste", "Harpalyke", "Praxidike", "Taygete", "Chaldene", "Kalyke", "Callirrhoe", "Megaclite", "Isonoe", "Erinome", "Saturn", "Pan", "Atlas", "Prometheus", "Pandora", "Epimetheus", "Janus", "Mimas", "Enceladus", "Tethys", "Telesto", "Calypso", "Dione", "Helene", "Rhea", "Titan", "Hyperion", "Iapetus", "Phoebe", "Uranus", "Cordelia", "Ophelia", "Bianca", "Cressida", "Desdemona", "Juliet", "Portia", "Rosalind", "Belinda", "Puck", "Miranda", "Ariel", "Umbriel", "Titania", "Oberon", "Caliban", "Stephano", "Sycorax", "Prospero", "Setebos", "Trinculo", "Neptune", "Naiad", "Thalassa", "Despina", "Galatea", "Larissa", "Proteus", "Triton", "Nereid", "Pluto", "Charon", "Nix", "Hydra", "Amalthea"], "index": 0, "layout": "IPY_MODEL_cc3947b6b03c4a7dab21028df9a6dc6a", "style": "IPY_MODEL_c31e25ba0d0449f6965c0bb06d50b452"}}, "d8df86840e0d40109ffe6ac511c1fcfc": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_2d1c435aa2974d01a737190c751be926", "placeholder": "Type something", "style": "IPY_MODEL_61bc818a123d46a7be565b3f339de3f1", "value": "Ever"}}, "da8614c7672d4eecadd2737b1c59d7e7": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_7e9969bc470a4b349a5618f9c7e801b5", "IPY_MODEL_9cedf3e89f9040a38960c0d20281db6f"], "layout": "IPY_MODEL_bae6e5d9fa6d49108f230fb4af681d0a"}}, "dbc8edf5ad284155ad80d4d4338dec9c": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "dcc96dd7fe7b4f45848b1fe85b133979": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "def9645218414232a631e7e14daf7797": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "e125bdbf129e4376876f5aeca3c0ea92": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "e35d6c0521c44f549524d45b97760084": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "TextareaModel", "state": {"layout": "IPY_MODEL_4e48202a1f894da8947aff591b752a1f", "placeholder": "Type something", "style": "IPY_MODEL_ed440825370f47758fefed7323587982", "value": "Every planet is a star-orbiter."}}, "e5c5fa35e5814ec4be7ebb41298c366c": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"index": null, "layout": "IPY_MODEL_2038c15743494d1eaa2416bd47a5175d", "style": "IPY_MODEL_fb4720ef6f014acb95892195b801f5de"}}, "e63b4521bbc84265882b4ca9931f891f": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "e6d28adbae1d4f36a73052c6b943813d": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "e8aa0bc57fca4700a03e4addf1cf8e16": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "e92e503d2522413eb840d3c6c02d66b6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "If", "No", "Nothing", "Something", "The", "X", "Earth", "Sun", "Mercury", "Venus", "Moon", "Mars", "Phobos", "Deimos", "Jupiter", "Metis", "Adrastea", "Thebe", "Io", "Europa", "Ganymede", "Callisto", "Themisto", "Leda", "Himalia", "Lysithea", "Elara", "Ananke", "Carme", "Pasiphae", "Sinope", "Iocaste", "Harpalyke", "Praxidike", "Taygete", "Chaldene", "Kalyke", "Callirrhoe", "Megaclite", "Isonoe", "Erinome", "Saturn", "Pan", "Atlas", "Prometheus", "Pandora", "Epimetheus", "Janus", "Mimas", "Enceladus", "Tethys", "Telesto", "Calypso", "Dione", "Helene", "Rhea", "Titan", "Hyperion", "Iapetus", "Phoebe", "Uranus", "Cordelia", "Ophelia", "Bianca", "Cressida", "Desdemona", "Juliet", "Portia", "Rosalind", "Belinda", "Puck", "Miranda", "Ariel", "Umbriel", "Titania", "Oberon", "Caliban", "Stephano", "Sycorax", "Prospero", "Setebos", "Trinculo", "Neptune", "Naiad", "Thalassa", "Despina", "Galatea", "Larissa", "Proteus", "Triton", "Nereid", "Pluto", "Charon", "Nix", "Hydra", "Amalthea"], "index": 0, "layout": "IPY_MODEL_4a140e21e6e44a49b538dfb1007385a6", "style": "IPY_MODEL_6356a9fc31784b789fde072db2f3bab1"}}, "e9c17ff64d474cb8a7b36b727ba6f3e6": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "e9e51c032cc6499295fc51167ecdd4f1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_e35d6c0521c44f549524d45b97760084", "IPY_MODEL_17a5280aae154d7f9ede482d7c947e78"], "layout": "IPY_MODEL_9cd0e0a310044843b7e34d6c79ba3b41"}}, "eb50cbc111ff4db291113ebc02b26bb5": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "ecab57e671f54f66971e1fd10690ce1a": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "ed440825370f47758fefed7323587982": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "edcefb046bdd4b62bf4c250d1b2509e8": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["Every", "Every-single-thing", "Earth", "Europa", "Elara", "Erinome", "Epimetheus", "Enceladus"], "index": 0, "layout": "IPY_MODEL_4c98f214f5334ab282e817c818e710fb", "style": "IPY_MODEL_3fda814c78254ee0943a98907b19faa0"}}, "effc1cd5acee4ca4a3b642f9ab222f19": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "f350b084a5c14d6587eef7500237d9f1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "VBoxModel", "state": {"children": ["IPY_MODEL_b6c8e30601054ef7a0cb6044e7b1f752", "IPY_MODEL_d47c504afff545ed8fe20e72c554993d"], "layout": "IPY_MODEL_670b0b974a3b469b8c4487be718093a3"}}, "f373c60a696749b18ccc965167b9dc58": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "f616b5d57c97428e8373c2aaadcde8fa": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {}}, "f666d81b663942b7827f50d6392b3d5d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "SelectModel", "state": {"_options_labels": ["anything", "every", "every-single-thing", "if", "no", "nothing", "something", "the", "the-one-and-only", "X", "Earth", "Sun", "Mercury", "Venus", "Moon", "Mars", "Phobos", "Deimos", "Jupiter", "Metis", "Adrastea", "Thebe", "Io", "Europa", "Ganymede", "Callisto", "Themisto", "Leda", "Himalia", "Lysithea", "Elara", "Ananke", "Carme", "Pasiphae", "Sinope", "Iocaste", "Harpalyke", "Praxidike", "Taygete", "Chaldene", "Kalyke", "Callirrhoe", "Megaclite", "Isonoe", "Erinome", "Saturn", "Pan", "Atlas", "Prometheus", "Pandora", "Epimetheus", "Janus", "Mimas", "Enceladus", "Tethys", "Telesto", "Calypso", "Dione", "Helene", "Rhea", "Titan", "Hyperion", "Iapetus", "Phoebe", "Uranus", "Cordelia", "Ophelia", "Bianca", "Cressida", "Desdemona", "Juliet", "Portia", "Rosalind", "Belinda", "Puck", "Miranda", "Ariel", "Umbriel", "Titania", "Oberon", "Caliban", "Stephano", "Sycorax", "Prospero", "Setebos", "Trinculo", "Neptune", "Naiad", "Thalassa", "Despina", "Galatea", "Larissa", "Proteus", "Triton", "Nereid", "Pluto", "Charon", "Nix", "Hydra", "Amalthea"], "index": 0, "layout": "IPY_MODEL_2b5cda67a4104b7bafe0c359c422d0ae", "style": "IPY_MODEL_146cedc816244442872a3cd1088e4757"}}, "f69cf8e7ab3943d681224b303529eba4": {"model_module": "@jupyter-widgets/base", "model_module_version": "1.1.0", "model_name": "LayoutModel", "state": {"width": "90%"}}, "f9018487e15e49d58270a9f1a03d38cd": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "fb4720ef6f014acb95892195b801f5de": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "fe4cbd51f6414bef86564bf189f8b4ba": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}, "ff2dcbb693dc40c88d71a2781e826073": {"model_module": "@jupyter-widgets/controls", "model_module_version": "1.4.0", "model_name": "DescriptionStyleModel", "state": {"description_width": "initial"}}}, "version_major": 2, "version_minor": 0}
</script></div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../modules.html" class="btn btn-neutral float-right" title="API Refrence" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../01_safari_explorer/Safari.html" class="btn btn-neutral float-left" title="‘African Wildlife’." accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Cognitum Services S.A.

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>